<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>PORTAL CONECTIVIDAD TTC</title>
    <!-- Favicon (ícono en la pestaña del navegador) -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">

    <!-- Incluir estilos y librerías necesarias -->
    <link rel="stylesheet" href="styles.css">
    <!-- Incluir FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

    <!-- Header con imagen de fondo pero sin mostrar título -->
    <header>
        <div class="date" id="currentDate"></div> <!-- Fecha en la parte alta derecha -->
    </header>

    <!-- Formulario para importar el archivo con margen superior -->
    <form id="uploadForm">
        <div>
            <input type="file" id="fileInput" accept=".xlsx">
            <button type="button" class="analizar" onclick="processFile()">Analizar</button>
            <!-- Icono de bote de basura (Limpiar todo) -->
            <button type="button" class="limpiar" onclick="clearAll()">
                <i class="fas fa-trash"></i>
            </button> 
        </div>
    </form>

    <!-- Aquí se mostrará el total de unidades sin comunicar -->
    <h4 id="unidadesSinComunicar" style="display: none;"></h4> <!-- Oculto inicialmente -->

    <!-- Botones para exportar y enviar por correo usando iconos, ocultos inicialmente -->
    <div id="iconButtons" style="text-align: center; margin-top: 20px; display: none;">
        <button type="button" onclick="exportToExcel()" title="Exportar a Excel" style="border: none; background: none;">
            <i class="fas fa-file-excel fa-2x" style="color: green;"></i>
        </button>

        <button type="button" onclick="exportToPDF()" title="Exportar a PDF" style="border: none; background: none;">
            <i class="fas fa-file-pdf fa-2x" style="color: red;"></i>
        </button>

        <button type="button" onclick="sendByEmail()" title="Enviar por correo" style="border: none; background: none;">
            <i class="fas fa-envelope fa-2x" style="color: #007BFF;"></i>
        </button>
    </div>

    <table id="resultsTable">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>SD</th> <!-- Columna SD añadida aquí -->
                <th>Tipo de dispositivo</th>
                <th>UID</th>
                <th>Teléfono</th>
                <th>Hora de último mensaje</th>
                <th>Creada</th>
                <th>Grupos</th>
                <th>Campos personalizados</th>
                <th>Días Sin Comunicación</th>
            </tr>
        </thead>
        <tbody>
            <!-- Resultados se mostrarán aquí -->
        </tbody>
    </table>

    <!-- Incluir scripts al final del body -->
    <!-- Incluir la librería xlsx.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Incluir jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <!-- Incluir autoTable para jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.14/jspdf.plugin.autotable.min.js"></script>
    <!-- Incluir nuestro script.js -->
    <script src="script.js"></script>
</body>
</html>
